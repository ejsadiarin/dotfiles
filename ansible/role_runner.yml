---
# NOTE: READ INSTRUCTIONS BELOW 
# - for roles to run individually, remote hosts, etc.
#
# (LOCALLY) Run with: ansible-playbook --ask-become-pass role_runner.yml
#
# (REMOTELY) Run with either of one: 
#  1. Run on all hosts on `inventory.ini`:
#
# ansible-playbook -i inventory/hosts.ini role_runner.yml --ask-become-pass -e "target_hosts=homelab"
#
#  2. Or, to override the host group:
#
#  ansible-playbook -i inventory.ini role_runner.yml -e "target_hosts=myservers" --ask-become-pass
#
#  3. You can also specify a host directly:
#
#  ansible-playbook -i 'remotehost.example.com,' role_runner.yml --ask-become-pass -e "target_hosts=remotehost.example.com"
#
- name: Role Runner
  hosts: "{{ target_hosts | default('localhost') }}"
  # connection: "{{ target_connection | default('local') }}"
  gather_facts: true

  pre_tasks:
    - name: Detect OS and put in machine_os variable
      ansible.builtin.set_fact:
        machine_os: "{{ ansible_facts['os_family'] | lower }}" # can be 'archlinux', 'debian', 'redhat', etc.

    - name: Show which host is running
      debug:
        msg: "Running on {{ inventory_hostname }}"

    - name: Show ansible_host
      debug:
        msg: "ansible_host: {{ ansible_host | default('undefined') }}"

    - name: Show ansible_user
      debug:
        msg: "ansible_user: {{ ansible_user | default('undefined') }}"

    - name: Show group names
      debug:
        msg: "Groups: {{ group_names }}"

    - name: Show all hostvars
      debug:
        var: hostvars[inventory_hostname]

  # you can add roles to run here
  roles:
    - js_ts_role

  # tasks:
  #   - name: Link .ideavimrc
  #     ansible.builtin.file:
  #       src: "{{ ansible_user_dir }}/dotfiles/.ideavimrc"
  #       dest: "{{ ansible_user_dir }}/.ideavimrc"
  #       state: link
  #
  #   - name: Link .vimrc
  #     ansible.builtin.file:
  #       src: "{{ ansible_user_dir }}/dotfiles/.vimrc"
  #       dest: "{{ ansible_user_dir }}/.vimrc"
  #       state: link
